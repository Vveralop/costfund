replicaCount: 1

serviceAccount: financial-instrument-valuation-models-qa-sa

volumes:
  list:
  - name: secrets-store-inline
    csi:
      driver: secrets-store.csi.k8s.io
      readOnly: true
      volumeAttributes:
        secretProviderClass: "secrets-provider-financial-instrument-valuation-models"

nameOverride: ""
fullnameOverride: ""

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

container:
  image:
    pullPolicy: Always
  ports:
    - name: http
      containerPort: 3000
      protocol: TCP
  volumeMounts:
    list:
     - name: secrets-store-inline
       mountPath: "/mnt/secrets-store"
       readOnly: true

vars:
  enabled: true
  list:
    - name: PORT
      value: "3000"
    - name: ENVIRONMENT
      value: "qa"
    - name: TYPE
      value: "bcl"
    - name: SERVICE
      value: 'cost-of-fund'
    - name: API_PREFIX
      value: "v1"
    - name: LOGGER_LEVEL
      value: "debug"
    - name: IS_DDB_LOCAL
      value: "false"
    - name: REGION
      valueFrom:
        secretKeyRef:
          name: secrets-qa-bcl-dynamodb-financial-instrument-valuation-models
          key: aws-region
    - name: ACCESSKEYID
      valueFrom:
        secretKeyRef:
          name: secrets-qa-bcl-dynamodb-financial-instrument-valuation-models
          key: aws-clientid
    - name: SECRETACCESSKEY
      valueFrom: 
        secretKeyRef:
          name: secrets-qa-bcl-dynamodb-financial-instrument-valuation-models
          key: aws-clientapikey
    - name: PATH_INNER_BCL
      #value: 'http://internal-alb-lambda-costo-fondo-1764726597.us-east-1.elb.amazonaws.com'
      value: 'https://gw.sb.apis.itauchile2.cl/inner/bcl/tesoreria/v1'
    - name: INNER_BCL_CLIENT_ID
      valueFrom: 
        secretKeyRef:
          name: secrets-qa-inner-bcl-financial-instrument-valuation-models
          key: bcl-clientid
    - name: INNER_BCL_CLIENT_SECRET
      valueFrom: 
        secretKeyRef:
          name: secrets-qa-inner-bcl-financial-instrument-valuation-models
          key: bcl-apikey
    - name: NODE_OPTIONS
      value: "--use-openssl-ca"
    - name: COMPONENT
      value: "bcl-cost-of-fund: 1.0.1"
    - name: TITLE
      value: "Cost of Fund"
    - name: APP_ID
      value: "3840"

secrets:

livenessEnabled: true
livenessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 5
  periodSeconds: 10

readinessEnabled: true
readinessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 5
  periodSeconds: 10

service: #PR-PREGUNTAR a CLOUDOPS
  type: ClusterIP
  port: 3000 

ingress:
  ingressClassName: ingress-internal
  enabled: true
  annotations:
    alb.ingress.kubernetes.io/target-type: 'ip'
    alb.ingress.kubernetes.io/scheme: internal
    alb.ingress.kubernetes.io/group.name: alb-qa-bcl-priv
    alb.ingress.kubernetes.io/healthcheck-path: /health
  rules:
    host: financial-instrument-valuation-models-3840.bcl-qa-ms.clouditauchile.cl
    path: "/"

resources:
  limits:
    cpu: 270m
    memory: 479Mi
  requests:
    cpu: 103m
    memory: 220Mi

autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 2
  targetCPUUtilizationPercentage: 60
  #targetMemoryUtilizationPercentage: 70